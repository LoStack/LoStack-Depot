services:
  pastefy:
    image: interaapps/pastefy:latest
    hostname: pastefy
    container_name: pastefy
    restart: unless-stopped
    networks:
    - traefik_network
    depends_on:
    - pastefy-db
    environment:
      HTTP_SERVER_PORT: 80
      HTTP_SERVER_CORS: '*'
      DATABASE_DRIVER: mysql
      DATABASE_NAME: pastefy
      DATABASE_USER: pastefy
      DATABASE_PASSWORD: ${DATABASE_PASSWORD}
      DATABASE_HOST: pastefy-db
      DATABASE_PORT: 3306
      SERVER_NAME: https://pastefy.${DOMAINNAME}:80
    labels:
    - lostack.enable=true
    # - traefik.http.routers.pastefy.rule=Host(`pastefy.${DOMAINNAME}`)
    - lostack.port=80
    - homepage.name=Pastefy
    - homepage.group=Pastebins
    - homepage.icon=mdi-clipboard-outline
    - homepage.description=Advanced Paste System
    - homepage.href=https://pastefy.${DOMAINNAME}/
    - lostack.autostart=true
    - lostack.group=pastefy
    - lostack.default_duration=15m
    - lostack.primary=true
    - lostack.tags=files,sharing,notes,code
    - lostack.project_url=https://github.com/interaapps/pastefy
    - lostack.details=Pastefy is an open source alternative to Gists or Pastebin. You want to share some code to your friends or just save it for yourself? Just paste it. Try out the public instance https://pastefy.app
  pastefy-db:
    image: mariadb:10.11
    hostname: pastefy-db
    container_name: pastefy-db
    networks:
    - traefik_network
    environment:
      MYSQL_ROOT_PASSWORD: ${ADMIN_PASSWORD}
      MYSQL_DATABASE: pastefy
      MYSQL_USER: pastefy
      MYSQL_PASSWORD: ${DATABASE_PASSWORD}
    volumes:
    - ${APPDATA_DIR}/pastefy:/var/lib/mysql
    labels:
    - homepage.name=Pastefy MariaBD
    - homepage.group=Databases
    - homepage.icon=mariadb
    - homepage.description=Pastefy DB
    - homepage.href=https://pastefy-db.${DOMAINNAME}/
    - lostack.autostart=true
    - lostack.group=pastefy
    - lostack.enable=true